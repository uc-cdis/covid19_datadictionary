$schema: "http://json-schema.org/draft-04/schema#"

id: "subject"
title: Subject
type: object
namespace: https://chicagoland.pandemicresponsecommons.org
category: administrative
program: '*'
project: '*'
description: >
  The collection of all data related to a specific subject in the
  context of a specific experiment.
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - created_datetime
  - updated_datetime
  - state

links:
  - exclusive: false
    required: true
    subgroup:
    - name: studies
      backref: subjects
      label: member_of
      target_type: study
      multiplicity: many_to_many
      required: false
    - name: projects
      backref: subjects
      label: data_from
      target_type: project
      multiplicity: many_to_one
      required: false

required:
  - submitter_id
  - type

uniqueKeys:
  - [id]
  - [project_id, submitter_id]

# Case properties
properties:
  $ref: "_definitions.yaml#/ubiquitous_properties"

  strain:
    description: >
      A lower-level taxonomic rank used in microbiology or virology, plants and rodents, usually at the intraspecific level (within a species)
    type: string
    termDef:
      - term: strain
        source: NCI Thesaurus
        term_id: C14419
        term_version: 20.03e (Release date:2020-03-31)

  taxon_id:
    description: >
      NCBI identifier for classification of organisms.
    type: integer
    termDef:
      - term: taxon_id
        source: NCI Thesaurus
        term_id: C54539
        term_version: 20.03e (Release date:2020-03-31)

  genome_length:
    description: >
      Number of basepairs of genome sequenced.
    type: integer

  genome_id:
    description: >
      PATRIC unique identifier for genome sequenced.
    type: string

  wuhan_not_wuhan:
    description: >
      Wuhan not Wuhan
    enum:
      - "0"
      - "1"

  geo_resolution:
    description: >
      Geo resolution
    type: string

  date_confirmation:
    description: >
      Date confirmation
    type: string

  lives_in_wuhan:
    description: >
      Lives in Wuhan
    type: string

  travel_history_dates:
    description: >
      Travel history dates
    type: array
    items:
      type: string

  travel_history_location:
    description: >
      Travel history location
    type: array
    items:
      type: string

  reported_market_exposure:
    description: >
      Reported market exposure
    type: string

  additional_information:
    description: >
      Additional information
    type: string

  chronic_disease:
    description: >
      Chronic disease
    type: string
    termDef:
      - term: chronic_disease
        source: NCI Thesaurus
        term_id: C165593
        term_version: 20.03e (Release date:2020-03-31)

  outcome:
    description: >
      Outcome
    type: string
    termDef:
      - term: source
        source: NCI Thesaurus
        term_id: C25683
        term_version: 20.03e (Release date:2020-03-31)

  date_death_or_discharge:
    description: >
      Date death or discharge
    type: string

  notes_for_discussion:
    description: >
      Notes for discussion
    type: string

  location:
    description: >
      Location
    type: string
    termDef:
      - term: location
        source: NCI Thesaurus
        term_id: C25341
        term_version: 20.03e (Release date:2020-03-31)

  case_in_country:
    description: >
      Case in country
    type:
      - integer
      - "null"

  summary:
    description: >
      Summary
    type: string
    termDef:
      - term: summary
        source: NCI Thesaurus
        term_id: C79170
        term_version: 20.03e (Release date:2020-03-31)

  if_onset_approximated:
    description: >
      If onset approximated
    enum:
      - "True"
      - "False"
      - "NA"

  exposure_start:
    description: >
      Exposure start
    type:
      - string
    termDef:
      - term: exposure_start
        source: NCI Thesaurus
        term_id: C83127
        term_version: 20.03e (Release date:2020-03-31)

  exposure_end:
    description: >
      Exposure end
    type:
      - string
    termDef:
      - term: exposure_end
        source: NCI Thesaurus
        term_id: C83138
        term_version: 20.03e (Release date:2020-03-31)

  link:
    description: >
      Link
    type: string
    termDef:
      - term: link
        source: NCI Thesaurus
        term_id: C47919
        term_version: 20.03e (Release date:2020-03-31)

  dob:
    description: >
      Date of birth (MM/DD/YYYY)
    type: string
    termDef:
      - term: dob
        source: NCI Thesaurus
        term_id: C68615
        term_version: 20.03e (Release date:2020-03-31)

  isolated:
    description: >
      state of isolated
    enum:
      - "True"
      - "False"

  infection_order:
    description: >
      the order of infection (This is a deprecated value for the DS4C data set)
    type: integer

  infected_by:
    description: >
      the ID of who infected the patient
    type: array
    items:
      type: string

  hospital:
    description: >
      hospitalized location
    type: string

  vital_status:
    term:
      $ref: "_terms.yaml#/vital_status"
    enum:
      - Alive
      - Dead
      - Lost to Follow-up
      - Unknown
    termDef:
      - term: Vital Status
        source: NCI Thesaurus
        term_id: C25717
        term_version: 18.11d (Release date:2018-11-26)

  covid_19_status:
    description: >
      a confirmed positive or negative covid-19 case
    enum:
      - Positive
      - Negative
      - Unknown
      - Not Reported    

  deceased_date:
    description: >
      the date of discharge
    type: string
    
  studies:
    $ref: "_definitions.yaml#/to_many"
  projects:
    $ref: "_definitions.yaml#/to_one_project"
