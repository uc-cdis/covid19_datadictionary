$schema: "http://json-schema.org/draft-04/schema#"

id: "subject"
title: Subject
type: object
namespace: https://chicagoland.pandemicresponsecommons.org
category: administrative
program: '*'
project: '*'
description: >
  The collection of all data related to a specific subject in the
  context of a specific experiment.
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - created_datetime
  - updated_datetime
  - state

links:
  - exclusive: false
    required: true
    subgroup:
    - name: studies
      backref: subjects
      label: member_of
      target_type: study
      multiplicity: many_to_many
      required: false
    - name: projects
      backref: subjects
      label: data_from
      target_type: project
      multiplicity: many_to_one
      required: false

required:
  - submitter_id
  - type

uniqueKeys:
  - [id]
  - [project_id, submitter_id]

# Case properties
properties:
  $ref: "_definitions.yaml#/ubiquitous_properties"

  taxon_id:
    description: >
      NCBI identifier for classification of organisms.
    type: integer
    termDef:
      - term: taxon_id
        source: NCI Thesaurus
        term_id: C54539
        term_version: 20.03e (Release date:2020-03-31)

# This prop originated from the nCoV2019 dataset
  date_confirmation:
    description: >
      Date of confirmation
    type: string

  travel_history_dates:
    description: >
      Travel history dates
    type: array
    items:
      type: string

  travel_history_location:
    description: >
      Travel history location
    type: array
    items:
      type: string

# This prop originated from the nCoV2019 dataset
  case_in_country:
    description: >
      The order of the cases in which they occured within each country.
    type:
      - integer
      - "null"

  link:
    description: >
      Link
    type: string
    termDef:
      - term: link
        source: NCI Thesaurus
        term_id: C47919
        term_version: 20.03e (Release date:2020-03-31)

  dob:
    description: >
      Date of birth (MM/DD/YYYY)
    type: string
    termDef:
      - term: dob
        source: NCI Thesaurus
        term_id: C68615
        term_version: 20.03e (Release date:2020-03-31)

# This prop originated from the DS4C dataset
  infected_by:
    description: >
      the ID of who infected the patient
    type: array
    items:
      type: string

# This prop originated from the nCoV2019 dataset
  vital_status:
    term:
      $ref: "_terms.yaml#/vital_status"
    enum:
      - Alive
      - Dead
      - Lost to Follow-up
      - Unknown
    termDef:
      - term: Vital Status
        source: NCI Thesaurus
        term_id: C25717
        term_version: 18.11d (Release date:2018-11-26)

# This prop originated from the DS4C dataset
  covid_19_status:
    description: >
      a confirmed positive or negative covid-19 case
    enum:
      - Positive
      - Negative
      - Unknown
      - Not Reported


  deceased_date:
    description: >
      the date of discharge
    type: string

  studies:
    $ref: "_definitions.yaml#/to_many"
  projects:
    $ref: "_definitions.yaml#/to_one_project"
